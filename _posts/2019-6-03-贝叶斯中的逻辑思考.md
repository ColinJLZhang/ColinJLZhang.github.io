---
layout:     post
title:      贝叶斯估计与逻辑思考
subtitle:   多个随机变量之间的逻辑问题
date:       2019-06-03
author:     Colin
header-img: img/post-bg-mma-5.jpg
catalog: true
comments: true
tags:
    - 概率论
    - 贝叶斯估计
---

### 背景

最近因为在看VAE遇到相当多的条件概率，以及多个随机分布的相互关联的情况，一遍复习一遍预习的我想到了伟大的 Thomas Bayes 于是前来膜拜！

<center>  
    <img src="..\..\..\..\img\article\225px-Thomas_Bayes.gif">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">Thomas Bayes</div>
</center>

首先看一眼贝叶斯定理的公式表达：
$$
P(A | B)=\frac{P(B | A) P(A)}{P(B)}
$$
其中P(A|B)是指在事件B发生的情况下事件A发生的概率。

然后来看看维基百科的描述：

>贝叶斯定理（英语：Bayes' theorem）是概率论中的一个定理，描述在已知一些条件下，某事件的发生概率。比如，如果已知某癌症与寿命有关，使用贝叶斯定理则可以通过得知某人年龄，来更加准确地计算出他罹患癌症的概率。

>通常，事件A在事件B已发生的条件下发生的概率，与事件B在事件A已发生的条件下发生的概率是不一样的。然而，这两者是有确定的关系的，贝叶斯定理就是这种关系的陈述。贝叶斯公式的一个用途，即通过已知的三个概率而推出第四个概率。贝叶斯定理跟随机变量的条件概率以及边缘概率分布有关。

>作为一个普遍的原理，贝叶斯定理对于所有概率的解释是有效的。这一定理的主要应用为贝叶斯推断，是推论统计学中的一种推断法。这一定理名称来自于托马斯·贝叶斯。

有点绕？ me too！

实际上，贝叶斯公式是在强调两个相互影响的随机变量之间的关系，比如 天气 与 打伞 这个两个会相互影响的随机变量他们的变量表如下：
<center >
  <div style="color:orange; display: inline-block; color: #255; padding: 2px;">

|天气 | 打伞
| --  | --
|晴天(S) | 是(Y)
|雨天(R) | 否(N)

</div>
</center>
分布律
<center >
  <div style="color:orange; display: inline-block; color: #255; padding: 2px;">

|          |S     | R   |  p |
|--        | --   | --  | -- |
|**Y**     | 0.5  | 0.2 | 0.7|
|**N**     | 0.1  | 0.2 | 0.3|
|**p**     | 0.6  | 0.4 |    |

</div>
</center>

注意在这里为了说明贝叶斯估计的意义我把概率设置的有悖于常理，<br>
我们假设有一个小明，他所在地一天有0.6的概率是晴天，0.4的概率是雨天；小明是一个爱打伞的人每天有0.7的概率在打伞，0.3的概率不打伞：

P(S) = 0.6,  P(Y) = 0.7 （P(R) = 0.4; P(N) = 0.3）

小明是一个奇怪的人，别人都是雨天打伞的可能大，但是小明却不是<br>
小明晴天打伞概率是0.5，雨天打伞概率是0.2；小明晴天不打伞的概率是0.1，雨天不打伞的概率是0.4，显然小明爱淋雨，可能也不太喜欢太阳：

P(S,Y) = 0.5, P(R,Y) = 0.2; P(S, N) = 0.1, P(R, N) = 0.4

请问：<br>
a. 今天已经下雨了，那么小明会打伞的概率是多少呢？根据贝叶斯估计可以得到这样的公式：
$$
P(Y|R) = \frac{P(R,Y)}{P(R)} = \frac {0.2} {0.4} = 0.5
$$
b. 今天是晴天，那么小明会打伞的概率是多少呢？
$$
P(Y|S) = \frac{P(S,Y)}{P(S)} = \frac{0.5}{0.6} = \frac5 6 = 0.8333
$$
我们观察一组有趣的比较：

联合概率：P(Y,S) = 0.5<br>
条件概率：P(Y|S) = 0.8333

我们可以看到，条件概率是大于联合概率， 这一点是很好理解的因为条件概率是联合概率除以另外一个概率（概率小于1）那么最后的结果肯定是大于联合概率的，从另外一个角度条件概率是确定了联合概率中的一个随机变量所以对于整个概率模型来讲肯定是随机性减小了所以会得到一个更加大的概率。

先验概率： P(Y) = 0.7<br>
条件概率： P(Y|S) = 0.8333

为了比较这两个概率我们不妨重写一下贝叶斯公式：
$$
P(Y|S) = \frac{P(S|Y)}{P(S)}P(Y)
$$
发现了什么有趣的东西吗？这里我们先卖个关子，后面详细展开
### 先验概率 后验概率 似然估计

在这三个概率中，我认为最先考虑的应该是先验概率，是讨论其他两个概率的基础。在很多的blog中都会根据因果关系定义这三个概率，但是我认为他们的定义是根据先验概率的确定而确定的，先看看其他blog的说法：

>先验概率（prior probability）是指根据以往经验和分析得到的概率，如全概率公式，它往往作为"由因求果"问题中的"因"出现的概率·<br>
>后验概率是信息理论的基本概念之一。在一个通信系统中，在收到某个消息之后，接收端所了解到的该消息发送的概率称为后验概率。<br>   
>似然估计，根据事件发生结果的统计对概率模型的参数进行估计，由因求果。


继续前面的例子，其包含了两个随机变量：W(天气)、U(雨伞)。按照一般的思考肯定可以得出，W是因，U是果。所以P(U)是先验概率，P(U\|W)是后验概率，P(W\|U)是似然估计。这样的理解肯定是没有问题的，但是如果我们把随机事件定义为A,B呢？那么A,B谁是因谁是果呢？面对这样的情况我们只要先定义了先验概率就确定了其他的概率，因为所有概率的实际意义是我们认为的赋予的或者说是我们一厢情愿的相信的，对于数学来说**因果是相对的逻辑是绝对的**，当我们认定了其中一个是因那么另外一个就是果，所以我认为先验概率是被定义的，

先验概率：任何一个随机事件x发生的概率都可以被定义为一个先验概率,P(x)。<br>
后验概率：与随机事件x相关的另外一个随机事件y已经发生的情况下，随机事件x的概率，P(x|y)。<br>
似然估计：根据随机事件x发生的情况去求随机y的概率P(y|x)。

### 两个随机变量的逻辑关系

到这里我们可以开始讨论两个随机变量具有怎样的逻辑关系，

1. 要求随机事件x,y必须是具有相关关系的，不具有相关关系的两个随机变量自然也就没有逻辑关系。
2. 通过定义x为先验概率确定了逻辑关系的研究对象（我们希望关注的是x随机变量的变化)
3. 后验概率则是通过随机事件y的发生我们对随机事件x的不确定性获得了一些信息，相当于说随机事件x不如以前那么随机了，由于事件y的确定使得事件x的随机性受到了一定的约束。

现在我们讨论前面提到的，先验概率： P(Y) = 0.7，后验概率： P(Y|S) = 0.8333的关系。

我们说后验概率减少了先验概率的随机性并不意味后验概率就一定比先验概率小或者大，而是说和先验概率比起来后验概率受到了一定的约束，这种约束文字上的表达是事件y目前已经发生即y对x的影响已经确定了，这样的表述描述成公式的表达即$\frac{P(S|Y)}{P(S)}$,这个公式就是对先验概率的约束。
$$
P(Y|S) = \frac{P(S|Y)}{P(S)}P(Y) 
$$

### 推广：多个随机变量的逻辑关系

那么既然贝叶斯公式是对随机变量的逻辑关系描述那么多个随机变量（三个及以上）的逻辑关系应该怎么表述呢？这里以三个随机变量a,b,c为例。

$P(A|B|C)$:事件C发生前提下事件B发生后导致事件A发生的概率 $C \rightarrow B \rightarrow A$<br>
$P(A|C|B)$:事件C发生前提下事件B发生后导致事件A发生的概率 $B \rightarrow C \rightarrow A$<br>
$P(A|(B,C))$: 事件(B,C)同时发生的前提下事件A发生的概率 $(B,C) \rightarrow A$

计算公式：

$$
\begin{eqnarray*}
&P(A|B|C)& = \frac{P(A,B,C)}{P(B,C)}P(C) \tag{1} \\
&P(A|C|B)& = \frac{P(A,B,C)}{P(B,C)}P(B) \tag{2} \\ 
&P(A|(B,C))& = \frac{P(A,B,C)}{P(B,C)} \tag{3} \\
\end{eqnarray*}
$$
<br>
$$
\begin{eqnarray*}
&P(A|B|C)&= P(A|(B,C))P(C) \tag{4} \\
&P(A|C|B)&= P(A|(B,C))P(B) \tag{5} \\
\end{eqnarray*}
$$


参考：

[icaoys 一个例子搞清...](https://blog.csdn.net/qq_23947237/article/details/78265026)



**HAPPY HACKING!**